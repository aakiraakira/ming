<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EINNALAB</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">
<style>
  :root{ --bg:#0b0b10; --bg2:#12121a; --accent:#8b0000; --text:#e9e9ef; --muted:#a7adba; }
  *{ box-sizing:border-box }
  html,body{ height:100% }
  body{
    margin:0; color:var(--text);
    font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    background: radial-gradient(1200px 800px at 15% 10%, #1b1b27 0%, var(--bg) 55%) no-repeat,
                linear-gradient(180deg, var(--bg2), var(--bg));
    overflow:hidden;
  }
  #chartdiv{ width:100%; height:100vh; max-width:100%; }

  .title{
    position:fixed; top:20px; left:50%; transform:translateX(-50%);
    font-weight:700; font-size:clamp(20px,3.8vw,42px); letter-spacing:.3px;
    text-shadow:0 12px 30px rgba(0,0,0,.45); pointer-events:none;
  }
  .loc{
    position:fixed; top:80px; left:50%; transform:translateX(-50%);
    background:rgba(18,18,26,.75); border:1px solid rgba(255,255,255,.10);
    backdrop-filter: blur(6px); padding:8px 12px; border-radius:999px;
    font-size:14px; color:var(--muted); box-shadow:0 8px 24px rgba(0,0,0,.35);
  }
  .btn{
    position:fixed; top:20px; right:20px;
    background:linear-gradient(180deg,#c41414,var(--accent)); color:#fff; border:none; border-radius:12px;
    padding:10px 14px; font-weight:600; cursor:pointer;
    box-shadow:0 12px 28px rgba(139,0,0,.35), inset 0 1px 0 rgba(255,255,255,.25);
  }
  .legend{
    position:fixed; left:20px; bottom:20px; color:var(--muted);
    background:rgba(18,18,26,.7); border:1px solid rgba(255,255,255,.08);
    border-radius:12px; padding:8px 12px; backdrop-filter: blur(6px);
  }
</style>
</head>
<body>

<div id="chartdiv"></div>
<div class="title">EINNALAB</div>
<div id="loc" class="loc">Tap a pin…</div>
<button id="resetBtn" class="btn">Reset view</button>
<div class="legend">Drag to rotate • Scroll/Pinch to zoom</div>

<!-- amCharts v5 -->
<script src="https://cdn.amcharts.com/lib/5/index.js"></script>
<script src="https://cdn.amcharts.com/lib/5/map.js"></script>
<script src="https://cdn.amcharts.com/lib/5/geodata/worldLow.js"></script>
<script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>

<script>
am5.ready(function () {
  // ---------- CONFIG ----------
  const ACCENT = am5.color(0x8b0000);
  const DEFAULT_ZOOM = 1.1;
  const FOCUS_ZOOM   = 2.6;
  const ROT_DUR      = 800;

  // All locations (your list)
  const LOCATIONS = [
    // Head Office
    { role:"Head Office", org:"EINNALAB - Singapore",
      address:["10 Anson Road #33-03", "International Plaza", "Singapore 079903"],
      lat: 1.2763, lon: 103.8467 },

    // R&D Office
    { role:"R&D Office", org:"EINNALAB - USA",
      address:["1700 Santa Fe Avenue", "Long Beach CA 90813"],
      lat: 33.7879, lon: -118.2159 },

    // Exclusive Distributors
    { role:"Exclusive Distributor", org:"EINNALAB - Hungary",
      address:["8468 Kolontár, Kossuth Str. 36"],
      lat: 47.1070, lon: 17.4340 },
    { role:"Exclusive Distributor", org:"EINNALAB - Slovakia",
      address:["Biskupa Kiralya, Komarno; Nitriansky; 94501"],
      lat: 47.7636, lon: 18.1227 },

    // Distributor – existing
    { role:"Distributor", org:"Poland", address:[], lat: 52.2297, lon: 21.0122 },

    // Distributor – new you requested
    { role:"Distributor", org:"Dubai, UAE", address:[],      lat:25.2048,  lon:55.2708 },
    { role:"Distributor", org:"India",      address:[],      lat:28.6139,  lon:77.2090 },
    { role:"Distributor", org:"Sri Lanka",  address:[],      lat: 6.9271,  lon:79.8612 },
    { role:"Distributor", org:"Cambodia",   address:[],      lat:11.5564,  lon:104.9282 },
    { role:"Distributor", org:"Taiwan",     address:[],      lat:25.0330,  lon:121.5654 },
    { role:"Distributor", org:"Hong Kong",  address:[],      lat:22.3193,  lon:114.1694 },
    { role:"Distributor", org:"Australia",  address:[],      lat:-33.8688, lon:151.2093 },
  ];

  // --------- ROOT/THEME ----------
  var root = am5.Root.new("chartdiv");
  root.setThemes([ am5themes_Animated.new(root) ]);

  // Hide amCharts logo (note: license required for production use)
  if (root._logo) root._logo.set("forceHidden", true);

  // --------- CHART (orthographic globe) ----------
  var chart = root.container.children.push(am5map.MapChart.new(root, {
    projection: am5map.geoOrthographic(),
    panX: "rotateX",
    panY: "rotateY",
    wheelY: "zoom",
    rotationX: 0,
    rotationY: 0,
    minZoomLevel: 1,
    maxZoomLevel: 8
  }));

  // Optional autorotate (stops on interaction)
  let autoRot;
  function startAutoRotate(){
    stopAutoRotate();
    autoRot = chart.animate({ key:"rotationX", from: chart.get("rotationX"),
      to: chart.get("rotationX")+360, duration:30000, loops:Infinity });
  }
  function stopAutoRotate(){ if(autoRot){ autoRot.stop(); autoRot=null; } }
  startAutoRotate();
  chart.chartContainer.events.on("pointerdown", stopAutoRotate);
  chart.chartContainer.events.on("wheel", stopAutoRotate);

  // --------- WORLD LAYER ----------
  var polygonSeries = chart.series.push(am5map.MapPolygonSeries.new(root, { geoJSON: am5geodata_worldLow }));
  polygonSeries.mapPolygons.template.setAll({
    tooltipText: "{name}",
    interactive: true,
    fillOpacity: 0.9,
    fill: am5.color(0x263042),
    stroke: am5.color(0x3d4860),
    strokeOpacity: 0.5
  });
  polygonSeries.mapPolygons.template.states.create("hover", { fill: am5.color(0x33425c) });

  // Background and graticules
  var backgroundSeries = chart.series.push(am5map.MapPolygonSeries.new(root, {}));
  backgroundSeries.mapPolygons.template.setAll({ fill: root.interfaceColors.get("alternativeBackground"), fillOpacity: .08, strokeOpacity: 0 });
  backgroundSeries.data.push({ geometry: am5map.getGeoRectangle(90, 180, -90, -180) });

  var graticuleSeries = chart.series.push(am5map.GraticuleSeries.new(root, {}));
  graticuleSeries.mapLines.template.setAll({ strokeOpacity:.15, stroke: am5.color(0x3d4860) });

  // --------- PINS ----------
  var pointSeries = chart.series.push(am5map.MapPointSeries.new(root, {}));

  // Build tooltip text with formatting
  function tooltipTextFrom(d){
    const title = `[fontSize:16px][bold]${d.role}[/]`;
    const org   = d.org ? `\n${d.org}` : "";
    const addr  = (d.address && d.address.length) ? ("\n" + d.address.join("\n")) : "";
    return `${title}${org}${addr}`;
  }

  // Bullet: pulsing red dot
  pointSeries.bullets.push(function () {
    const circle = am5.Circle.new(root, {
      radius: 6, fill: ACCENT, stroke: am5.color(0xffffff), strokeWidth: 1.5,
      cursorOverStyle: "pointer"
    });

    circle.animate({
      key: "scale", from: 1, to: 1.35, duration: 800,
      loops: Infinity, easing: am5.ease.yoyo(am5.ease.cubic)
    });

    // Tooltip instance per bullet
    circle.set("tooltip", am5.Tooltip.new(root, {
      getFillFromSprite: false,
      labelText: "{tooltip}",
    }));

    // Click → rotate & zoom
    circle.events.on("click", function(ev){
      const di = ev.target.dataItem;
      const ctx = di.dataContext;
      focusOn(ctx.lon, ctx.lat, ctx.role + (ctx.org ? (" – " + ctx.org) : ""));
    });

    return am5.Bullet.new(root, { sprite: circle });
  });

  // Data for pins
  pointSeries.data.setAll(LOCATIONS.map(loc => ({
    role: loc.role, org: loc.org, address: loc.address,
    tooltip: tooltipTextFrom(loc),
    geometry: { type:"Point", coordinates:[loc.lon, loc.lat] },
    lon: loc.lon, lat: loc.lat
  })));

  // --------- FOCUS / RESET ----------
  const locEl = document.getElementById("loc");

  function focusOn(lon, lat, label){
    stopAutoRotate();
    locEl.textContent = label;

    // center target under cursor (orthographic uses negative lon/lat)
    chart.animate({ key:"rotationX", to: -lon, duration: ROT_DUR, easing: am5.ease.out(am5.ease.cubic) });
    chart.animate({ key:"rotationY", to: -lat, duration: ROT_DUR, easing: am5.ease.out(am5.ease.cubic) });
    chart.animate({ key:"zoomLevel", to: FOCUS_ZOOM, duration: ROT_DUR });
  }

  function resetView(){
    pointSeries.bulletsContainer.children.each(b => b.hideTooltip && b.hideTooltip());
    locEl.textContent = "Tap a pin…";
    chart.animate({ key:"rotationX", to: 0, duration: 700, easing: am5.ease.out(am5.ease.cubic) });
    chart.animate({ key:"rotationY", to: 0, duration: 700, easing: am5.ease.out(am5.ease.cubic) });
    chart.animate({ key:"zoomLevel", to: DEFAULT_ZOOM, duration: 700 });
    startAutoRotate();
  }
  document.getElementById("resetBtn").addEventListener("click", resetView);

  // Initial zoom
  chart.set("zoomLevel", DEFAULT_ZOOM);
}); // end ready
</script>

</body>
</html>
